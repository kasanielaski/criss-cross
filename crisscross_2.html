<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<script src="http://code.jquery.com/jquery-2.2.0.min.js"></script>	
	<style>
		.field{
			display: inline-block;
			border: 3px solid #fcc;
			width: 50px;
			height: 50px;
			position: absolute;
			cursor: pointer;
		}
		.field-criss{
			background-image: url('criss.jpg');
			cursor: default;
		}
		.field-cross{
			background-image: url('cross.png');
			cursor: default;
		}
		.game-over{
			cursor: default;
		}
	</style>
</head>
<body>
	<script>
		$(function(){

			var mapWidth=10;
			var mapHeight=10;
			var winLength=5;

			for (var x = 1; x <= mapWidth; x++) {
				for (var y = 1; y <= mapHeight; y++) {
					$('<div></div>')
					.addClass('field')
					.attr('id','field'+x.toString()+'-'+y.toString())
					.data('x',x)
					.data('y',y)
					.css({left:(x-1)*50, top:(y-1)*50})
					.appendTo('#map')
				}
			}
			var checkSight=false;
			$('.field').on('click',function(){
				if ($(this).hasClass('field-criss')||$(this).hasClass('field-cross')) {
					return;
				};
				checkSight=!checkSight;
				$(this).addClass(checkSight?'field-criss':'field-cross');
				function check(x,y){
					return $('#field'+x.toString()+'-'+y.toString())
						.hasClass(checkSight?'field-criss':'field-cross')
				};
				var directions=[
					{x:1,y:0},
					{x:0,y:1},
					{x:1,y:1},
					{x:-1,y:1}
				];
				var startX=parseInt($(this).data('x'));
				var startY=parseInt($(this).data('y'));
				for (var i = 0; i < directions.length; i++) {
					var sum=0;
					$.each([-1,1],
						function(index, offset){
							var x = startX;
							var y = startY;
							do{
								x+=directions[i].x*offset;
								y+=directions[i].y*offset;
								sum++;
							}while(
								check(x,y)
							)
						}
					);
					if(sum-1>=winLength){
						alert('победили: '+(checkSight?'нули':'кресты'));
						$('.field').off('click');
						$('.field').addClass('game-over');
					}
				};						
			});
		});
	</script>
	<div id='map'>
	</div>
</body>
</html>